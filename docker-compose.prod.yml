# docker-compose.prod.yml
services:
  rekkoo-server:
    image: rekkoo-server-prod-${SAFE_BRANCH_NAME}:latest
    build:
      target: production
    env_file:
      - .env
    labels:
      - "traefik.enable=true"
      - "traefik.docker.network=proxy"
      - "traefik.http.services.rekkoo-server-prod.loadbalancer.server.port=3000"
      - "traefik.http.routers.rekkoo-server-prod.rule=Host(`${HOST}`)"
      - "traefik.http.routers.rekkoo-server-prod.entrypoints=${ENTRYPOINT}"
      - "traefik.http.routers.rekkoo-server-prod.tls=${USE_TLS}"
      - "traefik.http.routers.rekkoo-server-prod.tls.certresolver=letsencrypt"
      - "traefik.http.routers.rekkoo-server-prod.service=rekkoo-server-prod"
